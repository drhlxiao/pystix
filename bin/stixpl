#!/usr/bin/python3
# @author       : Hualin Xiao
# @date         : May. 11, 2021

import os
import sys


currentdir = os.path.dirname(os.path.realpath(__file__))
parentdir = os.path.dirname(currentdir)
sys.path.append(parentdir)
from stix.pipeline import raw_pipeline as pd
from stix.core import logger
from stix.pipeline import task_manager as tm
logger = logger.get_logger()



def start_pipeline():
    logger.info('Starting thread')
    t=tm.TaskManager(pd.main, sleep_time=120, max_exec_time=7200, task_name='stixpl')
    t.start()


# Start the thread
if __name__ == '__main__':
    start_pipeline()

